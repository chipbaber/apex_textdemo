## Intro to Oracle APEX Comments Theme Component - 101
Please watch the following video first before proceeding with the code below.
[Intro to the APEX Comments Theme Component Video](https://youtu.be/4Dl6_2wX-oE)

-- Below is a static query used in the video above for the comments 
```
select 13 id, 
       (sysdate-2) comment_date,
       lower(APEX_CUSTOM_AUTH.GET_USERNAME) user_name,
       'He really barrelled up this pitch. ' comment_text,
       'https://youtu.be/FbBq5-oaWU4' attribute_1, 
       'https://ayxzx2tnd0tqzed-sluggersapex.adb.us-ashburn-1.oraclecloudapps.com/ords/r/searchdemo/105/files/static/v7/baseballcards/tank.png' attribute_2
from dual
union all
select 14 id, 
       (sysdate) comment_date,
       'Coach Bill' user_name,
       'Excellent timing on the pitch, with good eye hand contact.' comment_text,
       ' ' attribute_1, 
       ' ' attribute_2
from dual
```

- Example HTML Code for the attributes section of the comments section. 
```
<a href="&ATTRIBUTE_1." target="_new">
<img src="&ATTRIBUTE_2." style="max-height:150px;"/>
&nbsp;
&ATTRIBUTE_1.</a>
```

## Building Row Level Comments on a Report with the Oracle APEX Comments Theme Component 

Please watch the following video before proceeding through the sample Code below. [Add](https://add)

- Navigate to SQL Worshop -> SQL Commands and execute the following to create a new table to hold our comments. Please not this is a sample table with the basics for the comments theme component. Highlight each command and click run or copy and paste one at a time. 

![](assets/2023-09-22-14-03-16.png)

```
  CREATE TABLE "COMMENTS" 
   (	"C_ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"PLAYER_ID" NUMBER NOT NULL ENABLE, 
	"COMMENTER" VARCHAR2(150) COLLATE "USING_NLS_COMP", 
	"COMMENT_DATE" TIMESTAMP (6),  
	"COMMENT_TEXT" VARCHAR2(6000) COLLATE "USING_NLS_COMP", 
	"ACTIONS" VARCHAR2(250) COLLATE "USING_NLS_COMP", 
	"ATTRIBUTE_1" VARCHAR2(6000) COLLATE "USING_NLS_COMP", 
	"ATTRIBUTE_2" VARCHAR2(6000) COLLATE "USING_NLS_COMP", 
	"ATTRIBUTE_3" VARCHAR2(6000) COLLATE "USING_NLS_COMP", 
	"ATTRIBUTE_4" VARCHAR2(6000) COLLATE "USING_NLS_COMP", 
	 CONSTRAINT "COMMENTS_PK" PRIMARY KEY ("C_ID")
  USING INDEX  ENABLE)  DEFAULT COLLATION "USING_NLS_COMP" ;

   COMMENT ON COLUMN "COMMENTS"."C_ID" IS 'primary key for each comment';
   COMMENT ON COLUMN "COMMENTS"."PLAYER_ID" IS 'foreign key connecting to the player id';
   COMMENT ON COLUMN "COMMENTS"."COMMENTER" IS 'name of person making comment';
   COMMENT ON COLUMN "COMMENTS"."COMMENT_DATE" IS 'date of comment';
   COMMENT ON COLUMN "COMMENTS"."COMMENT_TEXT" IS 'text of comment';
   COMMENT ON COLUMN "COMMENTS"."ACTIONS" IS 'freeform actions field';
   COMMENT ON COLUMN "COMMENTS"."ATTRIBUTE_1" IS 'freeform attribute field';
   COMMENT ON COLUMN "COMMENTS"."ATTRIBUTE_2" IS 'freeform attribute field';
   COMMENT ON COLUMN "COMMENTS"."ATTRIBUTE_3" IS 'freeform attribute field';
   COMMENT ON COLUMN "COMMENTS"."ATTRIBUTE_4" IS 'freeform attribute field';
   COMMENT ON TABLE "COMMENTS"  IS 'example table for comments';

alter table "SEARCHDEMO"."COMMENTS" add constraint
"COMMENTS_CON" foreign key ( "PLAYER_ID" ) references "TEAMSTATS" ( "ID" );
/
```

- To simplify the logic needed in our app later on we will create a trigger that on insert or update saves the APEX_USER performing the action and a timestamp of when the database action was performed. Copy and run this in SQL Commands. 

![](assets/2023-09-22-14-09-56.png)

```
create or replace trigger commentsTrigger
    before insert or update 
    on comments
    for each row
begin
    if inserting then
        :new.comment_date := systimestamp;
        :new.commenter := coalesce(sys_context('APEX$SESSION','APP_USER'),user);
    end if;
    :new.comment_date := sysdate;
    :new.commenter := coalesce(sys_context('APEX$SESSION','APP_USER'),user);
end commentsTrigger;
/
```

- The next part of this tutorial assumes the user has the knowledge to create an application, a page and a report. The tutorial starts with that in place. For this example we will leverage a classic report